<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Выбор локации — Ташкент</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
body{margin:0;font-family:sans-serif;background:#0b0f16;color:#d7e2f2}
header{padding:10px;background:#0e1420;border-bottom:1px solid #273248}
.tabs{display:flex;gap:8px;margin:10px}
.tab{padding:6px 12px;background:#1a2234;border:1px solid #273248;border-radius:6px;cursor:pointer}
.tab.active{background:#2160ff;color:#fff}
main{display:grid;grid-template-columns:300px 1fr;height:calc(100vh - 60px)}
.sidebar{padding:10px;overflow:auto;background:#121826;border-right:1px solid #273248}
.list{margin-top:10px}
.item{padding:6px;border:1px solid #273248;margin-bottom:6px;border-radius:6px;cursor:pointer}
.item:hover{border-color:#4aa8ff}
#map{width:100%;height:100%}
input{width:100%;padding:6px;margin:6px 0;border-radius:6px;border:1px solid #31405a;background:#0f1624;color:#fff}
</style>
</head>
<body>
<header>
  <h2>Локации — Ташкент</h2>
</header>
<div class="tabs">
  <div class="tab active" data-tab="metro">Метро</div>
  <div class="tab" data-tab="districts">Районы</div>
  <div class="tab" data-tab="address">Адреса</div>
</div>
<main>
  <div class="sidebar">
    <div id="metroTab" class="list"></div>
    <div id="districtsTab" class="list" style="display:none"></div>
    <div id="addressTab" style="display:none">
      <input id="addressInput" placeholder="Введите адрес вручную"/>
      <div class="muted">Или кликни на карте для координат</div>
    </div>
  </div>
  <div id="map"></div>
</main>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// ====== данные ======
const districts = [
  "Мирзо-Улугбек","Юнусабад","Чиланзар","Яшнабад","Сергели",
  "Алмазар","Шайхантахур","Учтепа","Бектемир","Яккасарай","Янгихаёт"
];
const metroStations = [
  // Чиланзарская
  "Олмазор","Чиланзар","Мирзо Улугбек","Новза","Миллий боғ",
  "Халқаро боғ'","Буюк ипак йули",
  // Узбекистанская
  "Беруний","Тинчлик","Чорсу","Гафур Гулом","Алишер Навои",
  "Ойбек","Тошкент","Машинасозлар","Чкалов","Минор","Бодомзор",
  // Юнусабадская
  "Шахристон","Юнусабад","Абдулла Қодирий","Хабиб Абдуллаев","Юнусобод"
];

// ====== карта ======
let map = L.map('map').setView([41.3111,69.2797], 12);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  maxZoom:19
}).addTo(map);
let marker=null;

function showMarker(lat,lng,label){
  if(marker) map.removeLayer(marker);
  marker=L.marker([lat,lng]).addTo(map).bindPopup(label).openPopup();
  map.setView([lat,lng],14);
}

// ====== списки ======
function renderMetro(){
  let box=document.getElementById("metroTab");
  box.innerHTML="";
  metroStations.forEach(name=>{
    let div=document.createElement("div");
    div.className="item"; div.textContent=name;
    div.onclick=()=>showMarker(41.31+Math.random()*0.05,69.28+Math.random()*0.05,name);
    box.appendChild(div);
  });
}
function renderDistricts(){
  let box=document.getElementById("districtsTab");
  box.innerHTML="";
  districts.forEach(name=>{
    let div=document.createElement("div");
    div.className="item"; div.textContent=name;
    div.onclick=()=>showMarker(41.3+Math.random()*0.07,69.25+Math.random()*0.07,name);
    box.appendChild(div);
  });
}
renderMetro(); renderDistricts();

// ====== вкладки ======
document.querySelectorAll(".tab").forEach(tab=>{
  tab.onclick=()=>{
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    tab.classList.add("active");
    document.getElementById("metroTab").style.display = tab.dataset.tab==="metro"?"block":"none";
    document.getElementById("districtsTab").style.display = tab.dataset.tab==="districts"?"block":"none";
    document.getElementById("addressTab").style.display = tab.dataset.tab==="address"?"block":"none";
  };
});

// ====== адрес ======
document.getElementById("addressInput").addEventListener("change",e=>{
  showMarker(41.31,69.28,"Адрес: "+e.target.value);
});
map.on("click",e=>{
  if(document.querySelector(".tab.active").dataset.tab==="address"){
    showMarker(e.latlng.lat,e.latlng.lng,`Выбрано: ${e.latlng.lat.toFixed(5)},${e.latlng.lng.toFixed(5)}`);
  }
});
</script>
</body>
</html>
