<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin v2 — синхронизация со справочником</title>
<style>
:root{--bg:#0b0f16;--panel:#121826;--panel2:#172133;--text:#d7e2f2;--muted:#9fb0c8;--border:#273248;--accent:#4aa8ff;--danger:#ef4444}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,Segoe UI,Roboto,Arial}
header{display:flex;gap:8px;align-items:center;padding:10px 12px;background:#0e1420;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10}
header .tab{padding:6px 10px;border-radius:8px;cursor:pointer}
header .tab.active{background:var(--accent);color:#fff}
main{padding:12px}
.panel{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px}
h3{margin:0 0 10px 0}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media (max-width:720px){.grid{grid-template-columns:1fr}}
label{display:block;margin-bottom:4px;color:#cfe0ff}
select,input{width:100%;padding:8px;border-radius:8px;border:1px solid #31405a;background:#0f1624;color:#e7f1ff}
.code{background:#0f1624;border:1px solid #31405a;border-radius:8px;padding:8px;font-family:ui-monospace,Consolas,Monaco,monospace;white-space:pre;overflow:auto;max-height:240px}
.hidden{display:none}
</style>
</head>
<body>
<header>
  <div class="tab active" data-tab="dict">Справочник</div>
  <div class="tab" data-tab="filters">Фильтры</div>
  <div class="tab" data-tab="fields">Поля</div>
  <div class="tab" data-tab="layout">Макет</div>
  <div class="tab" data-tab="preview">Предпросмотр</div>
</header>

<main>
  <section id="dict" class="tab-page">
    <h3>Справочник v39.30R</h3>
    <button id="btnReload" class="btn">Обновить из файла</button>
    <pre id="dictDump" class="code"></pre>
  </section>

  <section id="filters" class="tab-page hidden">
    <h3>Фильтры</h3>
    <div class="panel">
      <h4>Локация</h4>
      <div class="grid">
        <div><label>Страна</label><select id="country"></select></div>
        <div><label>Город</label><select id="city"></select></div>
        <div><label>Район</label><select id="district"></select></div>
        <div><label>Улица/Массив</label><select id="street"></select></div>
      </div>
    </div>
    <div class="panel">
      <h4>Фильтры объекта</h4>
      <div class="grid">
        <div><label>Категория</label><select id="category"></select></div>
        <div><label>Подкатегория</label><select id="subcategory"></select></div>
        <div><label>Цена от</label><input type="number" placeholder="от"></div>
        <div><label>Цена до</label><input type="number" placeholder="до"></div>
        <div><label>Площадь от</label><input type="number" placeholder="от м²"></div>
        <div><label>Площадь до</label><input type="number" placeholder="до м²"></div>
      </div>
    </div>
  </section>

  <section id="fields" class="tab-page hidden">
    <h3>Поля (доп. параметры)</h3>
    <p>Здесь можно настраивать параметры, которые не завязаны на справочник: цена, площадь, этаж, комнаты и т.д.</p>
  </section>

  <section id="layout" class="tab-page hidden">
    <h3>Макет</h3>
    <p>Drag&drop редактор для управления окнами интерфейса.</p>
  </section>

  <section id="preview" class="tab-page hidden">
    <h3>Предпросмотр</h3>
    <p>Здесь будет предпросмотр интерфейса (карточки, таблица, карта и т.п.).</p>
  </section>
</main>

<script>
// Переключение вкладок
document.querySelectorAll("header .tab").forEach(tab=>{
  tab.addEventListener("click",()=>{
    document.querySelectorAll("header .tab").forEach(t=>t.classList.remove("active"));
    document.querySelectorAll(".tab-page").forEach(p=>p.classList.add("hidden"));
    tab.classList.add("active");
    document.getElementById(tab.dataset.tab).classList.remove("hidden");
  });
});

// Заглушка справочника
const dictData = {
  meta:{version:"v39.30R"},
  locations:{country:[{name:"Узбекистан",cities:[{name:"Ташкент",districts:[{name:"Юнусабад",streets:["Юнус-1","Юнус-9"]}]}]}]},
  categories:[{name:"Квартира",children:["Аренда","Продажа"]},{name:"Дом",children:["Аренда","Продажа"]}]
};

document.getElementById("dictDump").textContent = JSON.stringify(dictData,null,2);

// Простая подгрузка фильтров
function fillOptions(sel,arr){ sel.innerHTML = (arr||[]).map(v=>`<option>${v}</option>`).join(""); }
fillOptions(document.getElementById("country"),["Узбекистан"]);
fillOptions(document.getElementById("city"),["Ташкент"]);
fillOptions(document.getElementById("district"),["Юнусабад"]);
fillOptions(document.getElementById("street"),["Юнус-1","Юнус-9"]);
fillOptions(document.getElementById("category"),["Квартира","Дом"]);
fillOptions(document.getElementById("subcategory"),["Аренда","Продажа"]);
</script>
</body>
</html>
